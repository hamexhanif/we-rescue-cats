<h2 mat-dialog-title>Add New Cat</h2>
<mat-dialog-content>
    <form [formGroup]="catForm" class="cat-form">
        <div class="form-row">
            <mat-form-field appearance="outline" class="full-width">
                <mat-label>Name</mat-label>
                <input matInput formControlName="name" placeholder="Enter cat name">
                <mat-error *ngIf="catForm.get('name')?.hasError('required')">
                    Name is required
                </mat-error>
            </mat-form-field>
        </div>

        <div class="form-row">
            <mat-form-field appearance="outline" class="half-width">
                <mat-label>Age</mat-label>
                <input matInput type="number" formControlName="age" placeholder="Age in years" min="0" max="25">
                <mat-error *ngIf="catForm.get('age')?.hasError('required')">
                    Age is required
                </mat-error>
                <mat-error *ngIf="catForm.get('age')?.hasError('min')">
                    Age must be at least 0
                </mat-error>
                <mat-error *ngIf="catForm.get('age')?.hasError('max')">
                    Age cannot exceed 25 years
                </mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline" class="half-width">
                <mat-label>Gender</mat-label>
                <mat-select formControlName="gender">
                    <mat-option value="MALE">Male</mat-option>
                    <mat-option value="FEMALE">Female</mat-option>
                </mat-select>
                <mat-error *ngIf="catForm.get('gender')?.hasError('required')">
                    Gender is required
                </mat-error>
            </mat-form-field>
        </div>

        <div class="form-row">
            <mat-form-field appearance="outline" class="full-width">
                <mat-label>Breed</mat-label>
                <input 
                    matInput 
                    formControlName="breed" 
                    placeholder="Type to search breeds..."
                    [matAutocomplete]="breedAutocomplete">
                <mat-autocomplete 
                    #breedAutocomplete="matAutocomplete" 
                    [displayWith]="displayBreed"
                    (optionSelected)="onBreedSelected($event)">
                    <mat-option 
                        *ngFor="let breed of filteredBreeds | async" 
                        [value]="breed">
                        {{ breed.name }}
                    </mat-option>
                </mat-autocomplete>
                <mat-error *ngIf="catForm.get('breed')?.hasError('required')">
                    Breed is required
                </mat-error>
            </mat-form-field>
        </div>

        <div class="form-row">
            <mat-form-field appearance="outline" class="full-width">
                <mat-label>Description</mat-label>
                <textarea matInput formControlName="description" placeholder="Describe the cat" rows="3"></textarea>
                <mat-error *ngIf="catForm.get('description')?.hasError('required')">
                    Description is required
                </mat-error>
            </mat-form-field>
        </div>

        <div class="form-row">
            <mat-form-field appearance="outline" class="full-width">
                <mat-label>Image URL (Optional)</mat-label>
                <input matInput formControlName="imageUrl" placeholder="Enter image URL">
            </mat-form-field>
        </div>

        <div class="form-row">
            <mat-form-field appearance="outline" class="half-width">
                <mat-label>Latitude</mat-label>
                <input matInput type="number" formControlName="latitude" placeholder="Latitude" step="any">
                <mat-error *ngIf="catForm.get('latitude')?.hasError('required')">
                    Latitude is required
                </mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline" class="half-width">
                <mat-label>Longitude</mat-label>
                <input matInput type="number" formControlName="longitude" placeholder="Longitude" step="any">
                <mat-error *ngIf="catForm.get('longitude')?.hasError('required')">
                    Longitude is required
                </mat-error>
            </mat-form-field>
        </div>

        <div class="form-row">
            <mat-form-field appearance="outline" class="full-width">
                <mat-label>Address</mat-label>
                <input matInput formControlName="address" placeholder="Enter full address">
                <mat-error *ngIf="catForm.get('address')?.hasError('required')">
                    Address is required
                </mat-error>
            </mat-form-field>
        </div>
    </form>
</mat-dialog-content>

<mat-dialog-actions align="end">
    <button mat-button (click)="onCancel()">Cancel</button>
    <button mat-raised-button color="primary" (click)="onSubmit()" [disabled]="!catForm.valid || isSubmitting">
        <mat-icon *ngIf="isSubmitting">hourglass_empty</mat-icon>
        {{isSubmitting ? 'Creating...' : 'Create Cat'}}
    </button>
</mat-dialog-actions>